# Simple production Dockerfile for API
FROM node:18-alpine

# Install ffmpeg
RUN apk add --no-cache ffmpeg

WORKDIR /app

# Copy everything
COPY . .

# Install dependencies
RUN npm install

# Build TypeScript
WORKDIR /app/apps/api
RUN npm run build

# Create necessary directories  
RUN mkdir -p /app/data /app/temp

# Set environment
ENV NODE_ENV=production
ENV PORT=8080

EXPOSE 8080

# Start the built application
CMD ["npm", "start"]